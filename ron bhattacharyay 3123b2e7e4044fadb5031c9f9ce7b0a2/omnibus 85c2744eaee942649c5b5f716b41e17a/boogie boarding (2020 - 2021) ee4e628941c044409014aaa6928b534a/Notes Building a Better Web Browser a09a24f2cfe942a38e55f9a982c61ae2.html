<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Notes: Building a Better Web Browser</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	text-indent: -1.7em;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
}
.highlight-gray {
	color: rgb(155,154,151);
}
.highlight-brown {
	color: rgb(100,71,58);
}
.highlight-orange {
	color: rgb(217,115,13);
}
.highlight-yellow {
	color: rgb(223,171,1);
}
.highlight-teal {
	color: rgb(15,123,108);
}
.highlight-blue {
	color: rgb(11,110,153);
}
.highlight-purple {
	color: rgb(105,64,165);
}
.highlight-pink {
	color: rgb(173,26,114);
}
.highlight-red {
	color: rgb(224,62,62);
}
.highlight-gray_background {
	background: rgb(235,236,237);
}
.highlight-brown_background {
	background: rgb(233,229,227);
}
.highlight-orange_background {
	background: rgb(250,235,221);
}
.highlight-yellow_background {
	background: rgb(251,243,219);
}
.highlight-teal_background {
	background: rgb(221,237,234);
}
.highlight-blue_background {
	background: rgb(221,235,241);
}
.highlight-purple_background {
	background: rgb(234,228,242);
}
.highlight-pink_background {
	background: rgb(244,223,235);
}
.highlight-red_background {
	background: rgb(251,228,228);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(55, 53, 47, 0.6);
	fill: rgba(55, 53, 47, 0.6);
}
.block-color-brown {
	color: rgb(100,71,58);
	fill: rgb(100,71,58);
}
.block-color-orange {
	color: rgb(217,115,13);
	fill: rgb(217,115,13);
}
.block-color-yellow {
	color: rgb(223,171,1);
	fill: rgb(223,171,1);
}
.block-color-teal {
	color: rgb(15,123,108);
	fill: rgb(15,123,108);
}
.block-color-blue {
	color: rgb(11,110,153);
	fill: rgb(11,110,153);
}
.block-color-purple {
	color: rgb(105,64,165);
	fill: rgb(105,64,165);
}
.block-color-pink {
	color: rgb(173,26,114);
	fill: rgb(173,26,114);
}
.block-color-red {
	color: rgb(224,62,62);
	fill: rgb(224,62,62);
}
.block-color-gray_background {
	background: rgb(235,236,237);
}
.block-color-brown_background {
	background: rgb(233,229,227);
}
.block-color-orange_background {
	background: rgb(250,235,221);
}
.block-color-yellow_background {
	background: rgb(251,243,219);
}
.block-color-teal_background {
	background: rgb(221,237,234);
}
.block-color-blue_background {
	background: rgb(221,235,241);
}
.block-color-purple_background {
	background: rgb(234,228,242);
}
.block-color-pink_background {
	background: rgb(244,223,235);
}
.block-color-red_background {
	background: rgb(251,228,228);
}
.select-value-color-default { background-color: rgba(206,205,202,0.5); }
.select-value-color-gray { background-color: rgba(155,154,151, 0.4); }
.select-value-color-brown { background-color: rgba(140,46,0,0.2); }
.select-value-color-orange { background-color: rgba(245,93,0,0.2); }
.select-value-color-yellow { background-color: rgba(233,168,0,0.2); }
.select-value-color-green { background-color: rgba(0,135,107,0.2); }
.select-value-color-blue { background-color: rgba(0,120,223,0.2); }
.select-value-color-purple { background-color: rgba(103,36,222,0.2); }
.select-value-color-pink { background-color: rgba(221,0,129,0.2); }
.select-value-color-red { background-color: rgba(255,0,26,0.2); }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="a09a24f2-cfe9-42a3-8e55-f9a982c61ae2" class="page sans"><header><h1 class="page-title">Notes: Building a Better Web Browser</h1><table class="properties"><tbody><tr class="property-row property-row-created_time"><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesCreatedAt"><path d="M6.98643729,14.0000972 C5.19579566,14.0000972 3.40419152,13.3106896 2.04245843,11.9323606 C-0.681017475,9.21200555 -0.680780251,4.76029539 2.04293482,2.04012507 C4.76664406,-0.68004331 9.22427509,-0.68004331 11.9480135,2.04013479 C13.272481,3.36277455 14,5.1330091 14,6.99552762 C14,8.87640182 13.2721894,10.6285043 11.9480135,11.9509302 C10.5679344,13.3105924 8.77756503,14.0000972 6.98643729,14.0000972 Z M10.2705296,7.00913883 L10.2705296,8.46099754 L10.2705296,8.65543362 L10.076181,8.65543362 L8.6543739,8.65543362 L5.72059514,8.65543362 L5.52619796,8.65543362 L5.52619796,8.46099754 L5.52619796,5.52541044 L5.52619796,3.37946773 L5.52619796,3.18502193 L5.72059514,3.18502193 L7.17253164,3.18502193 L7.36692883,3.18502193 L7.36692883,3.37946773 L7.36692883,6.81467358 L10.076181,6.81467358 L10.2705296,6.81467358 L10.2705296,7.00913883 Z M12.1601539,6.99552762 C12.1601539,5.61697497 11.6190112,4.32597154 10.6393933,3.34769528 C8.63253764,1.34336744 5.35197452,1.34061603 3.34153136,3.33944106 C3.33868273,3.34219247 3.33607716,3.34494388 3.33322852,3.34769528 C1.32397148,5.35459953 1.32372842,8.63641682 3.33322852,10.6433794 C5.34295224,12.6504489 8.62968901,12.6504489 10.6393933,10.6433794 C11.6190112,9.66506426 12.1601539,8.37408027 12.1601539,6.99552762 Z"></path></svg></span>Created</th><td><time>@August 24, 2021 4:00 PM</time></td></tr><tr class="property-row property-row-text"><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesText"><path d="M7,4.56818 C7,4.29204 6.77614,4.06818 6.5,4.06818 L0.5,4.06818 C0.223858,4.06818 0,4.29204 0,4.56818 L0,5.61364 C0,5.88978 0.223858,6.11364 0.5,6.11364 L6.5,6.11364 C6.77614,6.11364 7,5.88978 7,5.61364 L7,4.56818 Z M0.5,1 C0.223858,1 0,1.223858 0,1.5 L0,2.54545 C0,2.8216 0.223858,3.04545 0.5,3.04545 L12.5,3.04545 C12.7761,3.04545 13,2.8216 13,2.54545 L13,1.5 C13,1.223858 12.7761,1 12.5,1 L0.5,1 Z M0,8.68182 C0,8.95796 0.223858,9.18182 0.5,9.18182 L11.5,9.18182 C11.7761,9.18182 12,8.95796 12,8.68182 L12,7.63636 C12,7.36022 11.7761,7.13636 11.5,7.13636 L0.5,7.13636 C0.223858,7.13636 0,7.36022 0,7.63636 L0,8.68182 Z M0,11.75 C0,12.0261 0.223858,12.25 0.5,12.25 L9.5,12.25 C9.77614,12.25 10,12.0261 10,11.75 L10,10.70455 C10,10.4284 9.77614,10.20455 9.5,10.20455 L0.5,10.20455 C0.223858,10.20455 0,10.4284 0,10.70455 L0,11.75 Z"></path></svg></span>Property</th><td></td></tr><tr class="property-row property-row-multi_select"><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesMultipleSelect"><path d="M4,3 C4,2.447715 4.447715,2 5,2 L12,2 C12.5523,2 13,2.447716 13,3 C13,3.55228 12.5523,4 12,4 L5,4 C4.447715,4 4,3.55228 4,3 Z M4,7 C4,6.447715 4.447715,6 5,6 L12,6 C12.5523,6 13,6.447716 13,7 C13,7.55228 12.5523,8 12,8 L5,8 C4.447715,8 4,7.55228 4,7 Z M4,11 C4,10.447715 4.447715,10 5,10 L12,10 C12.5523,10 13,10.447716 13,11 C13,11.55228 12.5523,12 12,12 L5,12 C4.447715,12 4,11.55228 4,11 Z M2,4 C1.44771525,4 1,3.55228475 1,3 C1,2.44771525 1.44771525,2 2,2 C2.55228475,2 3,2.44771525 3,3 C3,3.55228475 2.55228475,4 2,4 Z M2,8 C1.44771525,8 1,7.55228475 1,7 C1,6.44771525 1.44771525,6 2,6 C2.55228475,6 3,6.44771525 3,7 C3,7.55228475 2.55228475,8 2,8 Z M2,12 C1.44771525,12 1,11.5522847 1,11 C1,10.4477153 1.44771525,10 2,10 C2.55228475,10 3,10.4477153 3,11 C3,11.5522847 2.55228475,12 2,12 Z"></path></svg></span>Tags</th><td></td></tr><tr class="property-row property-row-url"><th><span class="icon property-icon"><svg viewBox="0 0 14 14" style="width:14px;height:14px;display:block;fill:rgba(55, 53, 47, 0.4);flex-shrink:0;-webkit-backface-visibility:hidden" class="typesUrl"><path d="M3.73333,3.86667 L7.46667,3.86667 C8.49613,3.86667 9.33333,4.70387 9.33333,5.73333 C9.33333,6.7628 8.49613,7.6 7.46667,7.6 L6.53333,7.6 C6.01813,7.6 5.6,8.0186 5.6,8.53333 C5.6,9.04807 6.01813,9.46667 6.53333,9.46667 L7.46667,9.46667 C9.5284,9.46667 11.2,7.79507 11.2,5.73333 C11.2,3.6716 9.5284,2 7.46667,2 L3.73333,2 C1.6716,2 0,3.6716 0,5.73333 C0,7.124 0.762067,8.33453 1.88953,8.97713 C1.87553,8.83107 1.86667,8.6836 1.86667,8.53333 C1.86667,7.92013 1.98753,7.33447 2.2036,6.7978 C1.99267,6.4954 1.86667,6.12953 1.86667,5.73333 C1.86667,4.70387 2.70387,3.86667 3.73333,3.86667 Z M12.1095,5.28907 C12.1231,5.4356 12.1333,5.58307 12.1333,5.73333 C12.1333,6.34607 12.0101,6.9294 11.7931,7.46513 C12.0059,7.768 12.1333,8.13573 12.1333,8.53333 C12.1333,9.5628 11.2961,10.4 10.2667,10.4 L6.53333,10.4 C5.50387,10.4 4.66667,9.5628 4.66667,8.53333 C4.66667,7.50387 5.50387,6.66667 6.53333,6.66667 L7.46667,6.66667 C7.98187,6.66667 8.4,6.24807 8.4,5.73333 C8.4,5.2186 7.98187,4.8 7.46667,4.8 L6.53333,4.8 C4.4716,4.8 2.8,6.4716 2.8,8.53333 C2.8,10.59507 4.4716,12.2667 6.53333,12.2667 L10.2667,12.2667 C12.3284,12.2667 14,10.59507 14,8.53333 C14,7.14267 13.2375,5.93167 12.1095,5.28907 Z"></path></svg></span>URL</th><td><a href="https://blog.rossry.net/notes-james-mickens/" class="url-value">https://blog.rossry.net/notes-james-mickens/</a></td></tr></tbody></table></header><div class="page-body"><figure id="67b5a189-63a8-47f9-abfd-aa3278611473" class="image"><a href="Notes%20Building%20a%20Better%20Web%20Browser%20a09a24f2cfe942a38e55f9a982c61ae2/icon-c2.png"><img style="width:350px" src="Notes%20Building%20a%20Better%20Web%20Browser%20a09a24f2cfe942a38e55f9a982c61ae2/icon-c2.png"/></a></figure><p id="a791d0c6-2ed1-4aef-9b9d-6675f9aceffe" class="">These are my cursory notes from a talk given by <a href="http://research.microsoft.com/en-us/people/mickens/">James Mickens</a>​ of Microsoft Research, in March 2015, titled “Building a Better Web Browser”.</p><h1 id="56317469-e7c6-4a6f-bad0-951c9bcc0db3" class="">The State of Progress</h1><p id="1593485b-8d94-4508-9b52-ce4644575fdd" class="">Chrome, Opera isolate the renderer in separate processes—this allows tabs to crash on their own. …but the issue is that the browswer is still a monolithic kernel.</p><p id="c21ecb97-c947-4e21-927a-d35d6540c36f" class="">Servo—extra threading! …but still monolithic.</p><p id="da28aab3-ab7b-46c8-9a06-f198462614b5" class="">The problem: Browser developers take the monolithic design as a given, and tinker around the edges.</p><h1 id="1072668a-4f80-43e9-9f5f-cc2e8a7511de" class="">The Problem</h1><p id="7b15c5a0-b680-474e-8494-0984b7000ae7" class="">What is a browser trying to do? Provide services for origins—render, computation, i/o + messaging</p><ul id="3ce05e9a-9fa5-41e8-936b-78a4ebd74e2c" class="bulleted-list"><li>It provides origin = &lt;protocol, host, port&gt;</li></ul><p id="bd995f62-9826-478d-b1db-f98b1c05b458" class="">Render: HTML CSS MathML Aria WebGL video canvas images</p><p id="7fc0c624-e874-4f06-8463-c20ff49a3479" class="">IO: XHR DOM IndexedDB Cookies FileReader BrowserCache AppCache</p><p id="52e5fbe2-7260-45ac-a351-62a8ae750b7a" class="">Currently: providing services for origins, but they’re high-level and complex. You wouldn’t ask your operating system to implement Emacs in the kernel. …well, you might. That was a test; I’ve already called the police on you.</p><p id="7f8d77c4-2861-4ed9-aac4-3475cf49cd22" class="">Kernel: network, UI, storage (concurrency)</p><p id="f402ebc6-48ab-467f-9ba1-d5960ed7a350" class="">Usercode: rendering, javascript, parser</p><h1 id="92ddf213-23f9-4b15-a583-3f03aa3b209f" class="">Atlantis</h1><p id="3d9db03f-7ee2-4cde-a5c2-bb05618336fa" class="">Taglines: security, performance, robustness</p><h2 id="58fe1770-3cc5-4ff1-be40-e85e043d0b7c" class="">But first, some depressing things…</h2><p id="50968de7-6078-47c4-9578-c8dcf00aea8e" class="">Browsers offer many opportunities for parallelism! <em>ex:</em>​ HTML parsing, rendering, network and disk IO. But current architectures limit concurrency, suffer from races.</p><p id="87325b59-551e-4976-81ee-08c626863a79" class=""><strong>But the DOM model says:</strong>​ JS is single-threaded, and cannot see browser locks. <strong>So:</strong>​ JS execution should biglock the DOM. <strong>What does happen:</strong>​ NOT THAT.</p><p id="b1dc58be-3259-4609-be23-e8fd86ad3cb3" class="">But in reality, there’s just no concurrency re: the DOM. None. more at: <a href="http://www.srl.inf.ethz.ch/papers/pldi12-wr.pdf">Race Detection for Web Applications</a>​—Petrov <em>et al.</em>​, PLDI ‘12</p><blockquote id="addd0754-b146-498d-82ce-e3309221213d" class="">idiosyncratic abstraction​ (n.) an abstraction that is inconsistently applied throughout an application.</blockquote><p id="2b35c4ed-821e-4941-9857-fab5eaecc35d" class="">HTML5 screen-sharing attacks: <a href="http://en.wikipedia.org/wiki/Same-origin_policy">SOP</a> <strong>should</strong>​ prevent attacker.com from opening and screen-scraping bank.com (even after screen-sharing enabled). <strong>What does happen:</strong>​ NOT THAT.</p><p id="21c9b385-64ef-44c6-9b2a-55a64dc87ce0" class=""><strong>Principal instance:</strong>​ Web application code+data, scripting runtime (<em>e.g.</em>​ HTML CSS JS parser DOMtree WebKit parsing) …but if you wanted to, you could be rolling a Haskell runtime and LaTeX stack, or, like, whatever you wanted.</p><p id="94a616d5-3b2e-40f1-a08d-15a766717e39" class=""><strong>Kernel:</strong>​ Cross-principal messaging, principal creation, network, UI, storage.</p><p id="438b9c1d-e2f3-4f39-8f81-f86970f2e30b" class=""><strong>Interfaces:</strong> <em>Computation:</em>​ createPI(), sendMsg(), listenMsg(), <em>Storage:</em>​ put(), get(), <em>External:</em>​ HTTPStream, <em>IO:</em>​ randerImg(), listenGUI()</p><blockquote id="a8107bd2-016a-4ac2-a2c8-6871b921fca7" class="">I think that the browser community has accepted the notion that if we want fast performance and rapid innovation, we need to put up with a really grotesque software structure. Well, maybe for real bare-metal performance… but we don’t really need that. So all you undergrads out there who only code in C…get hip!</blockquote><p id="51e7e888-8e23-437a-96c6-fc68e0b453bc" class=""><strong>Good features we’d like to keep:</strong></p><ul id="a065ca17-4971-4576-b4ea-e74b84d1da3c" class="bulleted-list"><li>Easy to inspect pages</li></ul><ul id="cc450302-fa1c-4634-9258-c17b56b5bb25" class="bulleted-list"><li>Easy to compress/validate code</li></ul><p id="106cff59-57ee-4186-a733-8ce71e3ced51" class="">Atlantis executes abstract syntax trees!—see <a href="http://research.microsoft.com/en-us/projects/jszap/">JSZap: Compressing JavaScript Code</a>​, Burtscher <em>et al.</em>​ / Slim Binaries (<a href="http://dl.acm.org/citation.cfm?id=265576">ACM paywall</a>​) Franz and Kistler</p><p id="76facee7-be6b-4bac-9c66-c013c2a93bbe" class=""><strong>Common case:</strong>​ You don’t have to write the <em>extensible</em>​ web stack!—You’ll use GoogleStack, or FacebookStack; <em>sim.</em>​ jQuery vs Angular vs…</p><p id="84bd912e-6e26-4972-a684-38ff379a464a" class=""><strong>So…how much bigger is an Atlantis page?:</strong>​ Well, bigger. But remember: caching saves 81% of bytes, 75% of requests. Anyway, the backwards-compatible default: 762K (avg webpage is 1.6MB—this is 47% bigger).</p><blockquote id="20d902ab-5d5b-49f7-b70f-abfe751ebed2" class="">Typically, what you (contra.​ Gizmodo) care about in your browser performance is the ability to run a series of event handlers, not straight-line execution.</blockquote><p id="6b40475b-2e57-4170-97c9-49d2cff53c39" class="">Deny-by-default SOP protection.</p><p id="4632e823-20fb-422e-9c0c-637db3fb9742" class="">Presently: the renderer and JS engine have different heaps—can only communicate via RPC. <em>Ex.</em>​ the .innerHTML interface. (Obviously a dangerous interface…) As a WebDev, you’d like to be able to interpose in the innerHTML interface. We <strong>should</strong>​ be able to shim in order to get a reference to the oldInnerHTML, sanitize the input string, and do the thing. <strong>Nope!</strong></p><p id="7af84399-4800-44be-9f1e-7139eecd2517" class="">In a regular browser, web developers can’t control very many invariants, so adding new features opens portals to demon worlds.</p><p id="40eb2373-0dfb-4fa5-8326-eb55e94f15bc" class="">Atlantis… Sanitize innerHTML strings? I don’t need anyone’s permission!</p><ol type="1" id="ba1c5404-2c53-44e6-b48f-7d82528262c9" class="numbered-list" start="1"><li>Modern web browsers make it difficult to create fast, secure, robust web pages</li></ol><ol type="1" id="76f46509-9dba-4642-a891-81d50cf0f7b4" class="numbered-list" start="2"><li>Happens because browsers use bad abstractions, developers lack the ability to fix them.</li></ol><ol type="1" id="54e0ac58-9cac-403e-a2ce-6da43a7fbd9d" class="numbered-list" start="3"><li>Refactoring the browser and giving developers more control solves problems.</li></ol><p id="81aeebe2-b9aa-4f21-8498-545410266d2e" class="">Future Work: New abstractions for web privacy. / Private logical machines.</p><ul id="3640de8b-40ea-4263-8a2a-28b38199a411" class="bulleted-list"><li>Strictly follows your commands;</li></ul><ul id="e46e18b0-2f8e-470d-bc66-82abafbc4711" class="bulleted-list"><li>Disappears when you turn it off, and takes data with it.</li></ul><p id="ebec06a0-863e-4adb-905d-7bb89345eb2f" class=""><strong>Presently:</strong>​ Your dataset is sharded among many DSPs, who do what they want; MVC-wise, your devices are just views for M/Cs that live elsewhere. <strong>Note:</strong>​ Encryption is necessary but insufficient for this abstraction.</p><p id="72d3c7f2-ba0b-4413-bab0-86e740b39ed7" class=""><strong>Server-side:</strong>​ Encrypted computation. <strong>Client-side:</strong>​ Private browsing (does it work very well right now? probs not.)</p><p id="c4c169c8-90f8-4957-9187-c4c710a2148a" class=""><strong>Q:</strong>​ What if the WebDev doesn’t want to send a whole stack, and just wants to deliver native-code instead? <strong>A:</strong>​ Yeah, sure! Why not?</p><p id="c0732501-47ab-46ad-94a4-2da2cef76e58" class=""><em>Kohler:</em> <strong>Q:</strong>​ Since all of the kernels we’re using are microkernels, we’re all going to be using microkernel browsers by 2020, right? <strong>A:</strong>​ Well, we’re not on micros yet, but even so, the microkernel movement has had an influence on the sorts of monolithic kernels we see.</p><p id="851e3977-2225-47e4-a5e9-2acf9729806b" class="">Browsers are currently undergoing what Marx predicted would happen to Capitalism, being torn apart by internal contradictions.</p><p id="7e3c833e-017c-4cf3-a40e-bcb14cd65528" class=""><strong>Q:</strong>​ So what’s the first thing they’ll take from your work? <strong>A:</strong>​ The AtlantisKernel API.</p><p id="9a063dd6-044e-4c84-a9a5-f0e32d7511f0" class=""><strong>Q:</strong>​ So what’s the story on hardware APIs, for GPUs, webcams… <strong>A:</strong>​ Think of it like a USB-type thing; there’s a format it needs to go through for the webpage. Re: GPU, we’re not quite certain what the right interface is… It’s tricky.</p><p id="e1d1e446-56e1-4b28-9751-2d1f1b5cd7ec" class=""><strong>Q:</strong>​ What happens to the market in add-ons and extensions, which depend on everything being shipped out as markup? <strong>A:</strong>​ Pages themselves might have to opt-in to that, providing those sorts of interfaces to their data.</p><p id="c43236d9-1c7b-4402-911f-0c36bd89d207" class=""><strong>Postscript:</strong>​ It occurs to me, a few days later, that what James is describing is the idea of mutating individual sites from <a href="http://en.wikipedia.org/wiki/Unix_philosophy">Unix-philosophy</a>​, textbuffer-to-textbuffer piping applications to a server-and-ports, things-happen-on-the-inside model more reminiscient of full-fledged modern applications. In this framing, it is not at all surprising to me that the former is the way things have grown, and that people are now suggesting a jump away from it. (I could speculate at the coincidence of James’s suggestion and his position at that non-Unix company, Microsoft, but that might perhaps be impolitic.)</p></div></article></body></html>